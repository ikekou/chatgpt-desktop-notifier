(()=>{"use strict";let e={soundEnabled:!0,desktopEnabled:!0};function n(){const e=new AudioContext,n=e.createOscillator(),t=e.createGain();n.connect(t),t.connect(e.destination),n.type="sine",n.frequency.setValueAtTime(440,e.currentTime),t.gain.setValueAtTime(.1,e.currentTime),n.start(),n.stop(e.currentTime+.2)}function t(){const t=new MutationObserver((t=>{for(const d of t)if("childList"===d.type&&d.addedNodes.length>0){const t=d.addedNodes[d.addedNodes.length-1];if(t instanceof HTMLElement&&t.classList.contains("markdown")&&!t.classList.contains("notified")){t.classList.add("notified");const d=t.textContent?.slice(0,100)??"New response from ChatGPT";console.log("ðŸ¤– ChatGPTå¿œç­”ã‚’æ¤œå‡ºã—ã¾ã—ãŸ:",{timestamp:(new Date).toISOString(),preview:d,notificationSettings:{sound:e.soundEnabled,desktop:e.desktopEnabled}}),e.desktopEnabled&&chrome.runtime.sendMessage({type:"SHOW_NOTIFICATION",text:d}),e.soundEnabled&&n()}}})),d=document.querySelector("main");d&&(t.observe(d,{childList:!0,subtree:!0}),console.log("ðŸ” ChatGPTã®å¿œç­”ç›£è¦–ã‚’é–‹å§‹ã—ã¾ã—ãŸ"))}chrome.storage.sync.get(["soundEnabled","desktopEnabled"],(n=>{e={soundEnabled:n.soundEnabled??!0,desktopEnabled:n.desktopEnabled??!0}})),chrome.storage.onChanged.addListener((n=>{n.soundEnabled&&(e.soundEnabled=n.soundEnabled.newValue),n.desktopEnabled&&(e.desktopEnabled=n.desktopEnabled.newValue)})),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()})();