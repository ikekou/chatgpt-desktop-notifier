(()=>{"use strict";function e(){const e=new AudioContext,n=e.createOscillator(),t=e.createGain();n.connect(t),t.connect(e.destination),n.type="sine",n.frequency.setValueAtTime(440,e.currentTime),t.gain.setValueAtTime(.1,e.currentTime),n.start(),n.stop(e.currentTime+.2)}let n={soundEnabled:!0,desktopEnabled:!0};function t(){const t=new MutationObserver((t=>{for(const d of t)if("childList"===d.type&&d.addedNodes.length>0){const t=d.addedNodes[d.addedNodes.length-1];if(t instanceof HTMLElement&&t.classList.contains("markdown")&&!t.classList.contains("notified")){t.classList.add("notified");const d=t.textContent?.slice(0,100)??"New response from ChatGPT";console.log("ðŸ¤– ChatGPTå¿œç­”ã‚’æ¤œå‡ºã—ã¾ã—ãŸ:",{timestamp:(new Date).toISOString(),preview:d,notificationSettings:{sound:n.soundEnabled,desktop:n.desktopEnabled}}),n.desktopEnabled&&chrome.runtime.sendMessage({type:"SHOW_NOTIFICATION",text:d}),n.soundEnabled&&e()}}})),d=document.querySelector("main");d&&(t.observe(d,{childList:!0,subtree:!0}),console.log("ðŸ” ChatGPTã®å¿œç­”ç›£è¦–ã‚’é–‹å§‹ã—ã¾ã—ãŸ"))}chrome.storage.sync.get(["soundEnabled","desktopEnabled"],(e=>{n={soundEnabled:e.soundEnabled??!0,desktopEnabled:e.desktopEnabled??!0}})),chrome.storage.onChanged.addListener((e=>{e.soundEnabled&&(n.soundEnabled=e.soundEnabled.newValue),e.desktopEnabled&&(n.desktopEnabled=e.desktopEnabled.newValue)})),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()})();