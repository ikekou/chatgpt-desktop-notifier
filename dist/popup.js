(()=>{"use strict";const e=document.getElementById("soundEnabled"),t=document.getElementById("desktopEnabled"),n=document.getElementById("testSound"),o=document.getElementById("testNotification"),c=document.getElementById("status");function s(){const n={soundEnabled:e.checked,desktopEnabled:t.checked};chrome.storage.sync.set(n,(()=>{d("設定を保存しました")}))}function d(e){c.textContent=e,c.classList.add("show"),setTimeout((()=>{c.classList.remove("show")}),2e3)}chrome.storage.sync.get(["soundEnabled","desktopEnabled"],(n=>{e.checked=n.soundEnabled??!0,t.checked=n.desktopEnabled??!0})),e.addEventListener("change",s),t.addEventListener("change",s),n.addEventListener("click",(function(){e.checked?(function(){const e=new AudioContext,t=e.createOscillator(),n=e.createGain();t.connect(n),n.connect(e.destination),t.type="sine",t.frequency.setValueAtTime(440,e.currentTime),n.gain.setValueAtTime(.1,e.currentTime),t.start(),t.stop(e.currentTime+.2)}(),d("🔊 音声通知をテストしました")):d("⚠️ 音声通知が無効になっています")})),o.addEventListener("click",(function(){if(console.log("🔔 デスクトップ通知テストを開始します"),!t.checked)return console.log("⚠️ デスクトップ通知が無効になっています"),void d("⚠️ デスクトップ通知が無効になっています");console.log("📤 background.jsにメッセージを送信します"),chrome.runtime.sendMessage({type:"SHOW_NOTIFICATION",text:"これはテスト通知です。ChatGPT Desktop Notifierは正常に動作しています。"},(e=>{console.log("📥 background.jsからの応答:",e),chrome.runtime.lastError&&(console.error("❌ エラーが発生しました:",chrome.runtime.lastError),d("⚠️ 通知の送信に失敗しました"))})),d("💬 デスクトップ通知をテストしました")}))})();